#!/usr/bin/env python

import socket
import sys
import threading


TCP_IP = sys.argv[1]
TCP_PORT = int(sys.argv[2])
BUFFER_SIZE = 1024



def run_client_writable():
    print("Type message: ")
    while 1:
        msg = input()
        if msg == "q":
            sys.exit(0)
        s.send(msg.encode())
        print("(?) Message Sent\n")

    s.close()
    print("Connection closed")


def run_client_readable():
    while 1:
        data = s.recv(BUFFER_SIZE)
        if data == None:
            break
        print("Received: %s\n"%(data.decode("utf-8")))
        sys.stdout.flush()


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))


t = threading.Thread(target=run_client_readable, args=[])
t.start()
run_client_writable()
